[gd_scene load_steps=14 format=3 uid="uid://cpywa3bj60gk2"]

[ext_resource type="PackedScene" uid="uid://cj3s5sudjjbdv" path="res://scenes/camera/camera_parent.tscn" id="1_055aq"]
[ext_resource type="PackedScene" uid="uid://w5mymv1kldc1" path="res://scenes/player/player.tscn" id="1_siy02"]
[ext_resource type="PackedScene" uid="uid://db8vs710eb7mq" path="res://scenes/levels/level1.tscn" id="2_fu777"]
[ext_resource type="Script" path="res://scenes/camera/camera_parent.gd" id="2_q0fbw"]
[ext_resource type="Script" path="res://scenes/game/POVcam.gd" id="3_llk6a"]
[ext_resource type="PackedScene" uid="uid://dl2vajlt2r5da" path="res://scenes/levels/level2.tscn" id="6_47kk3"]
[ext_resource type="PackedScene" uid="uid://byp7vvsei1jru" path="res://scenes/glasses/glasses_pickup.tscn" id="6_xxfpe"]
[ext_resource type="Script" path="res://scenes/obstacles/obstacle_warning/obstacle_warning_factory.gd" id="8_ulr11"]
[ext_resource type="PackedScene" uid="uid://byp2hs35587k1" path="res://scenes/end_goal/end_goal.tscn" id="10_gc51s"]

[sub_resource type="GDScript" id="GDScript_j6dg8"]
script/source = "extends Node3D

#@onready var player: Player = get_tree().get_first_node_in_group(\"Player\")
#@onready var camera_parent: Node3D = $CameraParent
#
#func _ready():
    #var glasses: Glasses = get_tree().get_first_node_in_group(\"Glasses\")
    #var end_goal: EndGoal = get_tree().get_first_node_in_group(\"EndGoal\")
       #
    #if glasses != null:
        #glasses.glasses_picked_up.connect(on_glasses_picked_up)
        #
    #if end_goal != null:
        #end_goal.level_won.connect(on_level_won)
        #
#func on_glasses_picked_up(glasses: Glasses):
    #glasses.queue_free()
    #if player != null:
        #player.put_on_glasses()
    #camera_parent.turn_camera()
#
#func on_level_won(end_goal: EndGoal):
     #if (player.glasses_on != 1):
        #print(\"gagne\")
"

[sub_resource type="ViewportTexture" id="ViewportTexture_eg1oo"]
viewport_path = NodePath("Cam POV")

[sub_resource type="BoxMesh" id="BoxMesh_0n036"]

[sub_resource type="PlaceholderMesh" id="PlaceholderMesh_u2nx8"]

[node name="Game" type="Node3D"]
script = SubResource("GDScript_j6dg8")

[node name="UI" type="CanvasLayer" parent="."]

[node name="SpriteCamPOV" type="Sprite2D" parent="UI"]
position = Vector2(1048, 100)
scale = Vector2(0.363281, 0.363281)
texture = SubResource("ViewportTexture_eg1oo")

[node name="CameraParent" parent="." node_paths=PackedStringArray("camera", "player", "dummy_look_at") instance=ExtResource("1_055aq")]
script = ExtResource("2_q0fbw")
camera = NodePath("Camera3D")
player = NodePath("../Player")
dummy_look_at = NodePath("DummyLookAt")
camera_speed = 1.0
catchup_speed = 0.1
dummy_speed = 0.01

[node name="Camera3D" parent="CameraParent" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.866025, 0.5, 0, -0.5, 0.866025, 0, 7.5, 5)
cull_mask = 1048573
size = 11.252

[node name="DummyLookAt" type="Node3D" parent="CameraParent"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="CameraParent/DummyLookAt"]
visible = false
mesh = SubResource("BoxMesh_0n036")

[node name="Cam POV" type="SubViewport" parent="."]
transparent_bg = true
size = Vector2i(707, 512)
render_target_clear_mode = 1

[node name="Node3D" type="Node3D" parent="Cam POV" node_paths=PackedStringArray("target_position", "target_rotation")]
script = ExtResource("3_llk6a")
target_position = NodePath("../../Player/MeshInstance3D/MeshInstance3D/FishParent/Player")
target_rotation = NodePath("../../Player/MeshInstance3D")

[node name="Camera3D" type="Camera3D" parent="Cam POV/Node3D"]
transform = Transform3D(-0.880748, 0.0910525, -0.46475, -0.00512255, 0.979455, 0.2016, 0.473558, 0.179939, -0.862186, -1.30987, 0.719937, -2.08054)
cull_mask = 1048546
fov = 62.9

[node name="Player" parent="." instance=ExtResource("1_siy02")]

[node name="MeshInstance3D" parent="Player" index="0"]
mesh = SubResource("PlaceholderMesh_u2nx8")

[node name="Fish" parent="Player/MeshInstance3D/MeshInstance3D/FishParent" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="Bones" parent="Player/MeshInstance3D" index="2"]
transform = Transform3D(3.61999e-06, 1, 2.53518e-06, 1, -3.61999e-06, 0, 9.17733e-12, 2.53518e-06, -1, 0, 0, 0)

[node name="ObstacleWarningFactory" type="Node" parent="."]
script = ExtResource("8_ulr11")

[node name="glasses - pickup2" parent="." instance=ExtResource("6_xxfpe")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.5266, 0, -0.200001)

[node name="Levels" type="Node3D" parent="."]

[node name="Level1" parent="Levels" instance=ExtResource("2_fu777")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="Level2" parent="Levels" instance=ExtResource("6_47kk3")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -59.5)

[node name="EndGoal" parent="." instance=ExtResource("10_gc51s")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0.155, 0.215, 5.376)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.399519, -0.433013, -0.808013, 0.808013, -0.25, 0.533494, -0.433013, -0.866025, 0.25, 0, 0, 0)
layers = 3
light_color = Color(1, 0.945098, 0.819608, 1)
light_energy = 0.4
shadow_enabled = true
shadow_opacity = 0.9

[node name="DirectionalLight3D2" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.75, 0.5, 0.433013, 0.5, -5.47527e-08, 0.866025, 0.433013, 0.866025, -0.25, 0, 0, 0)
layers = 3
light_energy = 0.2
shadow_opacity = 0.55

[editable path="CameraParent"]
[editable path="Player"]
